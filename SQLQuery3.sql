-------- penggunaan database TQSL--------------
USE TSQL
GO

---jawaban soal nomor 1----
CREATE DATABASE db_pegawai_Kurniawatiagustina;
USE db_pegawai_Kurniawatiagustina;

---jawaban soal nomor 2  ----
CREATE TABLE T_PEGAWAI_Kurniawatiagustina 
	(nopeg char(4)primary key,nama varchar(25),
	golongan smallint, alamat varchar(50), masaKerja smallint, 
	gaji_pokok bigint, tunjangan bigint);

	---- jawaban soal nomor 3a------------
INSERT INTO T_PEGAWAI_Kurniawatiagustina
VALUES('0001', 'Kurniawati Agustina', '2','Jl.Sepanjang Masa', '10','3500000','1000000'),
		('0002', 'Muhammad Andrik', '4','Jl.Indah Bersamamu', '12','4000000','1200000'),
		('0003', 'Nur Vigianto Prayugo', '6','Jl.Yang terluka', '14','4500000','1400000'),
		('0004', 'Rina Oktaviana', '8','Jl.Selalu ada ', '16','5000000','1600000'),
		('0005', 'Dama Ardli', '10','Jl. Terindah', '18','5500000','1800000');


---------jawaban soal nomor 3b------ ---
CREATE TABLE T_ABSENSI_Kurniawatiagustina
	(nopeg char(4) foreign key (nopeg) REFERENCES 
	T_PEGAWAI_Kurniawatiagustina(nopeg)
	, tanggal date primary key, sakit smallint, 
	ijin smallint, alpha smallint);

	INSERT INTO T_ABSENSI_Kurniawatiagustina VALUES
('0001', '2021-01-01', 1, 0, 0),
('0002', '2021-01-02', 0, 1, 0),
('0003', '2021-01-03', 0, 0, 1),
('0004', '2021-01-04', 1, 0, 0),
('0005', '2021-01-05', 0, 1, 0),
('0001', '2021-01-06', 0, 0, 1),
('0002', '2021-01-07', 1, 0, 0),
('0003', '2021-01-08', 0, 1, 0),
('0004', '2021-01-09', 0, 0, 1),
('0005', '2021-01-10', 1, 0, 0),
('0001', '2021-01-11', 0, 1, 0),
('0002', '2021-01-12', 0, 0, 1),
('0003', '2021-01-13', 1, 0, 0),
('0004', '2021-01-14', 0, 1, 0),
('0005', '2021-01-15', 0, 0, 1),
('0001', '2021-01-16', 0, 0, 0),
('0002', '2021-01-17', 0, 0, 0),
('0003', '2021-01-18', 0, 0, 0),
('0004', '2021-01-19', 0, 0, 0),
('0005', '2021-01-20', 0, 0, 0),
('0001', '2021-01-21', 0, 0, 0),
('0002', '2021-01-22', 0, 1, 0),
('0003', '2021-01-23', 0, 0, 0),
('0004', '2021-01-24', 0, 0, 0),
('0005', '2021-01-25', 0, 0, 0),
('0001', '2021-01-26', 1, 0, 0),
('0002', '2021-01-27', 0, 0, 0),
('0003', '2021-01-28', 0, 0, 0),
('0004', '2021-01-29', 0, 0, 1),
('0005', '2021-01-30', 0, 0, 0),

('0001', '2021-02-01', 0, 0, 0),
('0002', '2021-02-02', 0, 0, 0),
('0003', '2021-02-03', 1, 0, 0),
('0004', '2021-02-04', 0, 0, 0),
('0005', '2021-02-05', 0, 1, 0),
('0001', '2021-02-06', 0, 0, 0),
('0002', '2021-02-07', 0, 0, 1),
('0003', '2021-02-08', 0, 0, 0),
('0004', '2021-02-09', 0, 0, 0),
('0005', '2021-02-10', 0, 0, 0),
('0001', '2021-02-11', 0, 0, 0),
('0002', '2021-02-12', 1, 0, 0),
('0003', '2021-02-13', 0, 0, 0),
('0004', '2021-02-14', 0, 0, 0),
('0005', '2021-02-15', 0, 1, 0),
('0001', '2021-02-16', 0, 0, 0),
('0002', '2021-02-17', 0, 0, 0),
('0003', '2021-02-18', 0, 0, 0),
('0004', '2021-02-19', 0, 0, 1),
('0005', '2021-02-20', 0, 0, 0),
('0001', '2021-02-21', 1, 0, 0),
('0002', '2021-02-22', 0, 0, 0),
('0003', '2021-02-23', 0, 0, 0),
('0004', '2021-02-24', 0, 0, 0),
('0005', '2021-02-25', 0, 0, 0),
('0001', '2021-02-26', 0, 0, 0),
('0002', '2021-02-27', 0, 1, 0),
('0003', '2021-02-28', 0, 0, 0),
('0004', '2021-02-29', 0, 0, 0),
('0005', '2021-02-30', 0, 0, 1),

('0001', '2021-03-01', 0, 0, 0),
('0002', '2021-03-02', 0, 0, 0),
('0003', '2021-03-03', 0, 0, 0),
('0004', '2021-03-04', 0, 0, 0),
('0005', '2021-03-05', 0, 0, 0),
('0001', '2021-03-06', 0, 0, 0),
('0002', '2021-03-07', 0, 0, 0),
('0003', '2021-03-08', 0, 0, 0),
('0004', '2021-03-09', 0, 0, 0),
('0005', '2021-03-10', 0, 0, 0),
('0001', '2021-03-11', 0, 0, 0),
('0002', '2021-03-12', 0, 0, 0),
('0003', '2021-03-13', 0, 0, 0),
('0004', '2021-03-14', 0, 0, 0),
('0005', '2021-03-15', 0, 0, 0),
('0001', '2021-03-16', 0, 0, 0),
('0002', '2021-03-17', 0, 0, 0),
('0003', '2021-03-18', 0, 0, 0),
('0004', '2021-03-19', 0, 0, 0),
('0005', '2021-03-20', 0, 0, 0),
('0001', '2021-03-21', 0, 0, 0),
('0002', '2021-03-22', 0, 0, 0),
('0003', '2021-03-23', 0, 0, 0),
('0004', '2021-03-24', 0, 0, 0),
('0005', '2021-03-25', 0, 0, 0),
('0001', '2021-03-26', 0, 0, 0),
('0002', '2021-03-27', 0, 0, 0),
('0003', '2021-03-28', 0, 0, 0),
('0004', '2021-03-29', 0, 0, 0),
('0005', '2021-03-30', 0, 0, 0),

('0001', '2021-04-01', 0, 0, 0),
('0002', '2021-04-02', 0, 0, 0),
('0003', '2021-04-03', 0, 0, 0),
('0004', '2021-04-04', 0, 0, 0),
('0005', '2021-04-05', 0, 0, 0),
('0001', '2021-04-06', 0, 0, 0),
('0002', '2021-04-07', 0, 0, 0),
('0003', '2021-04-08', 0, 0, 0),
('0004', '2021-04-09', 0, 0, 0),
('0005', '2021-04-10', 0, 0, 0),
('0001', '2021-04-11', 0, 0, 0),
('0002', '2021-04-12', 0, 0, 0),
('0003', '2021-04-13', 0, 0, 0),
('0004', '2021-04-14', 0, 0, 0),
('0005', '2021-04-15', 0, 0, 0),
('0001', '2021-04-16', 0, 0, 0),
('0002', '2021-04-17', 0, 0, 0),
('0003', '2021-04-18', 0, 0, 0),
('0004', '2021-04-19', 0, 0, 0),
('0005', '2021-04-20', 0, 0, 0),
('0001', '2021-04-21', 0, 0, 0),
('0002', '2021-04-22', 0, 0, 0),
('0003', '2021-04-23', 0, 0, 0),
('0004', '2021-04-24', 0, 0, 0),
('0005', '2021-04-25', 0, 0, 0),
('0001', '2021-04-26', 0, 0, 0),
('0002', '2021-04-27', 0, 0, 0),
('0003', '2021-04-28', 0, 0, 0),
('0004', '2021-04-29', 0, 0, 0),
('0005', '2021-04-30', 0, 0, 0),

('0001', '2021-06-01', 0, 0, 0),
('0002', '2021-06-02', 0, 0, 0),
('0003', '2021-06-03', 0, 0, 0),
('0004', '2021-06-04', 0, 0, 0),
('0005', '2021-06-05', 0, 0, 0),
('0001', '2021-06-06', 0, 0, 0),
('0002', '2021-06-07', 0, 0, 0),
('0003', '2021-06-08', 0, 0, 0),
('0004', '2021-06-09', 0, 0, 0),
('0005', '2021-06-10', 0, 0, 0),
('0006', '2021-06-11', 0, 0, 0),
('0001', '2021-06-12', 0, 0, 0),
('0002', '2021-06-13', 0, 0, 0),
('0003', '2021-06-14', 1, 0, 0),
('0004', '2021-06-15', 0, 0, 0),
('0005', '2021-06-16', 0, 0, 0),
('0006', '2021-06-17', 0, 0, 0),
('0001', '2021-06-18', 0, 0, 0),
('0002', '2021-06-19', 0, 0, 0),
('0003', '2021-06-20', 0, 1, 0),
('0004', '2021-06-21', 0, 0, 0),
('0005', '2021-06-22', 0, 0, 0),
('0001', '2021-06-23', 0, 0, 0),
('0002', '2021-06-24', 0, 0, 0),
('0003', '2021-06-25', 0, 0, 0),
('0004', '2021-06-26', 0, 0, 0),
('0005', '2021-06-27', 0, 0, 0),
('0001', '2021-06-28', 0, 0, 0),
('0002', '2021-06-29', 0, 0, 0),
('0003', '2021-06-30', 0, 0, 1);


------- Jawaban soal  nomor 4a----------
SELECT nopeg, nama, masakerja 
FROM pegawai_patria_anggara 
WHERE masakerja > 10 
ORDER BY masakerja DESC;
